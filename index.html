<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>緊急藥物禁忌症核對清單</title>
<style>
  body {
    font-family: "Noto Sans TC", Arial, sans-serif;
    background-color: #111; /* 深色背景 */
    color: #fff;
    margin: 0;
    padding: 20px;
  }
  h2 {
    text-align: center;
    color: #5dc1ff; /* 標題顏色 */
    margin-bottom: 30px;
  }
  /* 藥物容器與卡片樣式 */
  .med-container {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  .med-item {
    background-color: #1b1b1b;
    border-radius: 10px;
    overflow: hidden; /* 確保內容不會溢出 */
    border: 2px solid #333;
  }
  .med-card {
    display: block;
    width: 100%;
    text-align: center;
    color: #fff;
    padding: 20px 0;
    font-size: 22px;
    font-weight: bold;
    text-decoration: none;
    transition: 0.3s;
    cursor: pointer;
    background-color: #1b1b1b;
    border: none;
  }
  /* 點擊後啟用狀態 */
  .med-card.active {
    background-color: #e91e63; /* 點擊後保持亮色 */
    box-shadow: 0 0 12px rgba(233, 30, 99, 0.5);
  }

  /* 核對清單區域 */
  .checklist-area {
    padding: 10px 15px;
    display: none; /* 預設隱藏 */
  }
  .checklist-area p {
    font-size: 16px;
    color: #ccc;
    margin-top: 0;
    margin-bottom: 10px;
    font-weight: bold;
  }
  .checklist-area label {
    display: flex;
    align-items: center;
    font-size: 15px;
    margin-bottom: 5px;
  }
  .checklist-area input[type="checkbox"] {
    transform: scale(1.1);
    margin-right: 10px;
    flex-shrink: 0; /* 避免核取方塊被擠壓 */
  }

  /* 藥物執行方框文字 */
  .result-box {
    margin: 15px 0 0 0;
    padding: 15px;
    background-color: #008800; /* 綠色背景表示安全 */
    color: #fff;
    border-radius: 8px;
    font-size: 18px;
    font-weight: bold;
    text-align: center;
    display: none; /* 預設隱藏 */
    box-shadow: 0 0 10px #008800;
  }
</style>
</head>
<body>
  <h2>緊急藥物禁忌症核對</h2>

  <div class="med-container">
    
    <div class="med-item" id="aspirinItem">
      <button class="med-card" data-drug="aspirin">Aspirin 3顆▶️需做EKG</button>
      <div class="checklist-area">
        <p>請確認無以下禁忌症：</p>
        <label><input type="checkbox" class="chk-aspirin"> 病患對阿斯匹林類過敏</label>
        <label><input type="checkbox" class="chk-aspirin"> 病患有嚴重貧血、凝血缺陷或服用抗凝血劑</label>
        <label><input type="checkbox" class="chk-aspirin"> 病患有出血點、大片瘀血或疑似活動性病理性出血(例如:主動脈剝離、消化道出血)</label>
        <label><input type="checkbox" class="chk-aspirin"> 病患有顱內出血病史</label>
        <label><input type="checkbox" class="chk-aspirin"> 需做12導程ECG</label>
        <label><input type="checkbox" class="chk-aspirin"> 需雙側肢體脈壓差&lt;20mmHg</label>
        
        <div class="result-box">口服3顆(300mg)絞碎吞下</div>
      </div>
    </div>

    <div class="med-item" id="ntgItem">
      <button class="med-card" data-drug="ntg">NTG最多 3顆▶️T2可協助給予</button>
      <div class="checklist-area">
        <p>請確認無以下禁忌症：</p>
        <label><input type="checkbox" class="chk-ntg"> 收縮壓&lt;90mmHg</label>
        <label><input type="checkbox" class="chk-ntg"> 脈搏&lt;50 次/分鐘。</label>
        <label><input type="checkbox" class="chk-ntg"> 服用中西壯陽藥者。</label>
        <label><input type="checkbox" class="chk-ntg"> 對NTG過敏</label>
        <label><input type="checkbox" class="chk-ntg"> 需做12導程ECG</label>
        <label><input type="checkbox" class="chk-ntg"> 右心衰竭者(如有頸靜脈怒張或下肢嚴重水腫等症狀)。</label>
        
        <div class="result-box">口服3顆(300mg)絞碎吞下</div>
      </div>
    </div>
    
    <div class="med-item" id="ticagrelorItem">
      <button class="med-card" data-drug="ticagrelor">Ticagrelor 2顆▶️需致電MD確認</button>
      <div class="checklist-area">
        <p>請確認無以下禁忌症：</p>
        <label><input type="checkbox" class="chk-ticagrelor"> 病患對 Ticagrelor (Brilinta)類過敏</label>
        <label><input type="checkbox" class="chk-ticagrelor"> 病患有嚴重貧血、凝血缺陷或服用抗凝血劑</label>
        <label><input type="checkbox" class="chk-ticagrelor"> 病患有出血點、大片瘀血或疑似活動性病理性出血(例如:主動脈剝離、消化道出血)</label>
        <label><input type="checkbox" class="chk-ticagrelor"> 病患有顱內出血病史</label>
        <label><input type="checkbox" class="chk-ticagrelor"> 病患有嚴重肝功能不全</label>
        
        <div class="result-box">通知線上醫導 口服2顆(180mg)絞碎吞下</div>
      </div>
    </div>


  </div>

<script>
  // 獲取所有藥物按鈕
  const medCards = document.querySelectorAll('.med-card');
  let currentOpenItem = null; // 追蹤當前展開的藥物項目

  // ----------------------------------
  // 函數：檢查特定藥物的核取方塊狀態
  // ----------------------------------
  function checkChecklist(drugName) {
    // 根據藥物名稱，選取對應的核取方塊
    const checkboxes = document.querySelectorAll(`.chk-${drugName}`);
    // 獲取結果顯示框 (Result Box)
    const resultBox = document.querySelector(`#${drugName}Item .result-box`);
    
    // 檢查是否所有核取方塊都被勾選
    const allChecked = Array.from(checkboxes).every(c => c.checked);

    if (allChecked) {
      resultBox.style.display = 'block'; // 全部勾選則顯示結果
    } else {
      resultBox.style.display = 'none'; // 否則隱藏結果
    }
  }

  // ----------------------------------
  // 函數：處理按鈕點擊
  // ----------------------------------
  function handleCardClick(event) {
    const card = event.currentTarget;
    const item = card.closest('.med-item'); // 獲取當前按鈕所在的父容器 (med-item)
    const checklistArea = item.querySelector('.checklist-area');
    const drugName = card.getAttribute('data-drug');
    
    // 如果點擊的是當前已經打開的項目 (收回動作)
    if (currentOpenItem === item) {
      checklistArea.style.display = 'none';
      card.classList.remove('active');
      item.querySelector('.result-box').style.display = 'none'; // 隱藏結果
      currentOpenItem = null;
    } else {
      // 點擊新的項目 (展開動作)
      
      // 1. 關閉並重置所有其他項目
      if (currentOpenItem) {
        currentOpenItem.querySelector('.checklist-area').style.display = 'none';
        currentOpenItem.querySelector('.med-card').classList.remove('active');
        currentOpenItem.querySelector('.result-box').style.display = 'none';
      }

      // 2. 展開當前項目
      checklistArea.style.display = 'block';
      card.classList.add('active');
      currentOpenItem = item;

      // 3. 初始檢查清單狀態（確保結果框能立即根據預設狀態顯示）
      checkChecklist(drugName);
    }
  }
  
  // ----------------------------------
  // 監聽器設定
  // ----------------------------------

  // 1. 監聽藥物按鈕點擊事件 (展開/收回清單)
  medCards.forEach(card => {
    card.addEventListener('click', handleCardClick);
  });

  // 2. 監聽所有核取方塊的變化 (控制結果方框)
  const allCheckboxes = document.querySelectorAll('.checklist-area input[type="checkbox"]');
  allCheckboxes.forEach(checkbox => {
    checkbox.addEventListener('change', function() {
      // 根據核取方塊的 class 來判斷是哪個藥物，並執行檢查
      if (this.classList.contains('chk-ticagrelor')) {
        checkChecklist('ticagrelor');
      } else if (this.classList.contains('chk-aspirin')) {
        checkChecklist('aspirin');
      } else if (this.classList.contains('chk-ntg')) {
        checkChecklist('ntg');
      }
    });
  });

</script>
</body>
</html>
